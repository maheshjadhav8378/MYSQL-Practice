SELECT e.FIRST_NAME FROM employees e LEFT JOIN job_history j
ON e.EMPLOYEE_ID=j.EMPLOYEE_ID
WHERE j.EMPLOYEE_ID IS NULL;

SELECT e.FIRST_NAME,e.EMPLOYEE_ID,j.* FROM employees e LEFT JOIN job_history j
ON e.EMPLOYEE_ID=j.EMPLOYEE_ID;






















SELECT  j.JOB_TITLE,e.FIRST_NAME, avg(SALARY) FROM employees e INNER JOIN jobs j
ON e.JOB_ID=j.JOB_ID
INNER JOIN job_history jh
ON e.EMPLOYEE_ID= jh.EMPLOYEE_ID
GROUP BY j.JOB_TITLE,e.FIRST_NAME;




SELECT  j.JOB_TITLE, avg(SALARY) FROM employees e INNER JOIN jobs j
ON e.JOB_ID=j.JOB_ID
INNER JOIN job_history jh
ON e.EMPLOYEE_ID= jh.EMPLOYEE_ID
GROUP BY j.JOB_TITLE;

SELECT d.DEPARTMENT_NAME, e.MANAGER_ID,
COUNT(EMPLOYEE_ID) FROM departments d INNER JOIN employees e
ON d.MANAGER_ID=e.MANAGER_ID
GROUP BY e.MANAGER_ID,d.DEPARTMENT_NAME
HAVING COUNT(EMPLOYEE_ID)>5;


SELECT e.MANAGER_ID,
COUNT(EMPLOYEE_ID) FROM departments d INNER JOIN employees e
ON d.MANAGER_ID=e.MANAGER_ID
GROUP BY e.MANAGER_ID
HAVING COUNT(EMPLOYEE_ID)>5;

SELECT d.DEPARTMENT_ID FROM employees e INNER JOIN departments d
ON d.DEPARTMENT_ID=e.DEPARTMENT_ID
WHERE DATEDIFF(SYSDATE(),HIRE_DATE)>(2*365);

SELECT d.DEPARTMENT_NAME FROM employees e INNER JOIN departments d
ON d.DEPARTMENT_ID = e.DEPARTMENT_ID
GROUP BY DEPARTMENT_NAME
HAVING MAX(SALARY)>10000;

SELECT j.*, e.FIRST_NAME FROM employees e INNER JOIN jobs j
ON j.JOB_ID=e.JOB_ID
INNER JOIN job_history jh
ON e.EMPLOYEE_ID=jh.EMPLOYEE_ID
WHERE jh.JOB_ID='IT_PROG';

SELECT j.*, e.FIRST_NAME FROM employees e INNER JOIN jobs j
ON j.JOB_ID=e.JOB_ID
INNER JOIN job_history jh
ON e.EMPLOYEE_ID=jh.EMPLOYEE_ID;

SELECT * FROM employees
WHERE SALARY=(SELECT DISTINCT SALARY FROM employees ORDER BY SALARY DESC LIMIT 2,1);

SELECT * FROM employees 
WHERE COMMISSION_PCT IS NOT NULL AND SALARY BETWEEN 5000 AND 10000 AND DEPARTMENT_ID=30;



























































